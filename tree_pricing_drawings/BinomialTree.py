import networkx as nx
import matplotlib.pyplot as plt

class BinomialTree:
    def __init__(self, matrix):
        self.G = nx.DiGraph()
        self.matrix = matrix
        self.labels = {}
        self.pos = None
        self.create_tree()
        self.set_node_labels()
    def create_tree(self):
        rows = len(self.matrix)
        for i in range(rows):
            for j in range(i+1):
                parent = (i, j)
                if i + 1 < rows:
                    left_child = (i+1, j+1)
                    right_child = (i+1, j)
                    self.G.add_edge(parent, right_child)
                    self.G.add_edge(parent, left_child)

    def set_node_labels(self):
        for node in self.G.nodes():
            i, j = node
            try:
                self.labels[node] ="$V_{"+str(i)+"}"+f"$={self.matrix[i][j]:.2f}"
            except Exception:
                self.labels[node] ='outofbound'

    def draw_tree(self):
        if self.pos is None:
            self.pos = nx.nx_pydot.graphviz_layout(self.G, prog='dot')

        scale = 1.0 / len(self.matrix)
        pos = nx.nx_pydot.graphviz_layout(self.G, prog='dot')
        # pos_graphviz = {k: (-v[1] * scale, v[0] * scale) for k, v in pos.items()}

        pos_graphviz = {k: (-v[1], v[0]) for k, v in self.pos.items()}

        fig, ax = plt.subplots(figsize=(10+int(1/scale), int(1/scale)))

        nx.draw(self.G, pos_graphviz, with_labels=True, labels=self.labels, node_size=1000, node_color='#FF0800', font_size=10, font_color='black')
        plt.show()
        
        
if __name__ == '__main__':
    # Define default parameters
    matrix=[[100.        ,   0.        ,   0.        ,   0.        ],
            [ 98.28286296, 101.74713779,   0.        ,   0.        ],
            [ 96.59521152, 100.        , 103.52480048,   0.        ],
            [ 94.93653937,  98.28286296, 101.74713779, 105.33352138]]
    
    matrix_big=[[100.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 99.45377471, 100.5492253 ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 98.91053304, 100.        , 101.10146708,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 98.37025869,  99.45377471, 100.5492253 , 101.65674192,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 97.83293545,  98.91053304, 100.        , 101.10146708,
        102.21506647,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 97.29854722,  98.37025869,  99.45377471, 100.5492253 ,
        101.65674192, 102.77645747,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 96.76707794,  97.83293545,  98.91053304, 100.        ,
        101.10146708, 102.21506647, 103.34093178,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 96.23851169,  97.29854722,  98.37025869,  99.45377471,
        100.5492253 , 101.65674192, 102.77645747, 103.90850632,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 95.7128326 ,  96.76707794,  97.83293545,  98.91053304,
        100.        , 101.10146708, 102.21506647, 103.34093178,
        104.47919813,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 95.1900249 ,  96.23851169,  97.29854722,  98.37025869,
         99.45377471, 100.5492253 , 101.65674192, 102.77645747,
        103.90850632, 105.05302431,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 94.67007291,  95.7128326 ,  96.76707794,  97.83293545,
         98.91053304, 100.        , 101.10146708, 102.21506647,
        103.34093178, 104.47919813, 105.6300021 ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 94.15296102,  95.1900249 ,  96.23851169,  97.29854722,
         98.37025869,  99.45377471, 100.5492253 , 101.65674192,
        102.77645747, 103.90850632, 105.05302431, 106.2101488 ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 93.63867374,  94.67007291,  95.7128326 ,  96.76707794,
         97.83293545,  98.91053304, 100.        , 101.10146708,
        102.21506647, 103.34093178, 104.47919813, 105.6300021 ,
        106.79348181,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 93.12719562,  94.15296102,  95.1900249 ,  96.23851169,
         97.29854722,  98.37025869,  99.45377471, 100.5492253 ,
        101.65674192, 102.77645747, 103.90850632, 105.05302431,
        106.2101488 , 107.38001863,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 92.61851132,  93.63867374,  94.67007291,  95.7128326 ,
         96.76707794,  97.83293545,  98.91053304, 100.        ,
        101.10146708, 102.21506647, 103.34093178, 104.47919813,
        105.6300021 , 106.79348181, 107.96977686,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 92.11260559,  93.12719562,  94.15296102,  95.1900249 ,
         96.23851169,  97.29854722,  98.37025869,  99.45377471,
        100.5492253 , 101.65674192, 102.77645747, 103.90850632,
        105.05302431, 106.2101488 , 107.38001863, 108.56277419,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 91.60946324,  92.61851132,  93.63867374,  94.67007291,
         95.7128326 ,  96.76707794,  97.83293545,  98.91053304,
        100.        , 101.10146708, 102.21506647, 103.34093178,
        104.47919813, 105.6300021 , 106.79348181, 107.96977686,
        109.15902841,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 91.10906918,  92.11260559,  93.12719562,  94.15296102,
         95.1900249 ,  96.23851169,  97.29854722,  98.37025869,
         99.45377471, 100.5492253 , 101.65674192, 102.77645747,
        103.90850632, 105.05302431, 106.2101488 , 107.38001863,
        108.56277419, 109.75855741,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 90.6114084 ,  91.60946324,  92.61851132,  93.63867374,
         94.67007291,  95.7128326 ,  96.76707794,  97.83293545,
         98.91053304, 100.        , 101.10146708, 102.21506647,
        103.34093178, 104.47919813, 105.6300021 , 106.79348181,
        107.96977686, 109.15902841, 110.36137918,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 90.11646597,  91.10906918,  92.11260559,  93.12719562,
         94.15296102,  95.1900249 ,  96.23851169,  97.29854722,
         98.37025869,  99.45377471, 100.5492253 , 101.65674192,
        102.77645747, 103.90850632, 105.05302431, 106.2101488 ,
        107.38001863, 108.56277419, 109.75855741, 110.96751179,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 89.62422704,  90.6114084 ,  91.60946324,  92.61851132,
         93.63867374,  94.67007291,  95.7128326 ,  96.76707794,
         97.83293545,  98.91053304, 100.        , 101.10146708,
        102.21506647, 103.34093178, 104.47919813, 105.6300021 ,
        106.79348181, 107.96977686, 109.15902841, 110.36137918,
        111.57697344,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 89.13467684,  90.11646597,  91.10906918,  92.11260559,
         93.12719562,  94.15296102,  95.1900249 ,  96.23851169,
         97.29854722,  98.37025869,  99.45377471, 100.5492253 ,
        101.65674192, 102.77645747, 103.90850632, 105.05302431,
        106.2101488 , 107.38001863, 108.56277419, 109.75855741,
        110.96751179, 112.18978241,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 88.64780069,  89.62422704,  90.6114084 ,  91.60946324,
         92.61851132,  93.63867374,  94.67007291,  95.7128326 ,
         96.76707794,  97.83293545,  98.91053304, 100.        ,
        101.10146708, 102.21506647, 103.34093178, 104.47919813,
        105.6300021 , 106.79348181, 107.96977686, 109.15902841,
        110.36137918, 111.57697344, 112.80595708,   0.        ,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 88.16358398,  89.13467684,  90.11646597,  91.10906918,
         92.11260559,  93.12719562,  94.15296102,  95.1900249 ,
         96.23851169,  97.29854722,  98.37025869,  99.45377471,
        100.5492253 , 101.65674192, 102.77645747, 103.90850632,
        105.05302431, 106.2101488 , 107.38001863, 108.56277419,
        109.75855741, 110.96751179, 112.18978241, 113.42551593,
          0.        ,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 87.68201219,  88.64780069,  89.62422704,  90.6114084 ,
         91.60946324,  92.61851132,  93.63867374,  94.67007291,
         95.7128326 ,  96.76707794,  97.83293545,  98.91053304,
        100.        , 101.10146708, 102.21506647, 103.34093178,
        104.47919813, 105.6300021 , 106.79348181, 107.96977686,
        109.15902841, 110.36137918, 111.57697344, 112.80595708,
        114.04847756,   0.        ,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 87.20307086,  88.16358398,  89.13467684,  90.11646597,
         91.10906918,  92.11260559,  93.12719562,  94.15296102,
         95.1900249 ,  96.23851169,  97.29854722,  98.37025869,
         99.45377471, 100.5492253 , 101.65674192, 102.77645747,
        103.90850632, 105.05302431, 106.2101488 , 107.38001863,
        108.56277419, 109.75855741, 110.96751179, 112.18978241,
        113.42551593, 114.67486066,   0.        ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 86.72674563,  87.68201219,  88.64780069,  89.62422704,
         90.6114084 ,  91.60946324,  92.61851132,  93.63867374,
         94.67007291,  95.7128326 ,  96.76707794,  97.83293545,
         98.91053304, 100.        , 101.10146708, 102.21506647,
        103.34093178, 104.47919813, 105.6300021 , 106.79348181,
        107.96977686, 109.15902841, 110.36137918, 111.57697344,
        112.80595708, 114.04847756, 115.304684  ,   0.        ,
          0.        ,   0.        ,   0.        ],
       [ 86.25302221,  87.20307086,  88.16358398,  89.13467684,
         90.11646597,  91.10906918,  92.11260559,  93.12719562,
         94.15296102,  95.1900249 ,  96.23851169,  97.29854722,
         98.37025869,  99.45377471, 100.5492253 , 101.65674192,
        102.77645747, 103.90850632, 105.05302431, 106.2101488 ,
        107.38001863, 108.56277419, 109.75855741, 110.96751179,
        112.18978241, 113.42551593, 114.67486066, 115.9379665 ,
          0.        ,   0.        ,   0.        ],
       [ 85.78188639,  86.72674563,  87.68201219,  88.64780069,
         89.62422704,  90.6114084 ,  91.60946324,  92.61851132,
         93.63867374,  94.67007291,  95.7128326 ,  96.76707794,
         97.83293545,  98.91053304, 100.        , 101.10146708,
        102.21506647, 103.34093178, 104.47919813, 105.6300021 ,
        106.79348181, 107.96977686, 109.15902841, 110.36137918,
        111.57697344, 112.80595708, 114.04847756, 115.304684  ,
        116.57472714,   0.        ,   0.        ],
       [ 85.31332403,  86.25302221,  87.20307086,  88.16358398,
         89.13467684,  90.11646597,  91.10906918,  92.11260559,
         93.12719562,  94.15296102,  95.1900249 ,  96.23851169,
         97.29854722,  98.37025869,  99.45377471, 100.5492253 ,
        101.65674192, 102.77645747, 103.90850632, 105.05302431,
        106.2101488 , 107.38001863, 108.56277419, 109.75855741,
        110.96751179, 112.18978241, 113.42551593, 114.67486066,
        115.9379665 , 117.21498504,   0.        ],
       [ 84.84732108,  85.78188639,  86.72674563,  87.68201219,
         88.64780069,  89.62422704,  90.6114084 ,  91.60946324,
         92.61851132,  93.63867374,  94.67007291,  95.7128326 ,
         96.76707794,  97.83293545,  98.91053304, 100.        ,
        101.10146708, 102.21506647, 103.34093178, 104.47919813,
        105.6300021 , 106.79348181, 107.96977686, 109.15902841,
        110.36137918, 111.57697344, 112.80595708, 114.04847756,
        115.304684  , 116.57472714, 117.85875939]]
    
    BinomialTree(matrix_big).draw_tree()
